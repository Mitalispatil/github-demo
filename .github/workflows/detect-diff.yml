name: Detect Code Changes

on: [push]

jobs:
  detect-changes:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout current code
      uses: actions/checkout@v3
      with:
        fetch-depth: 2   # Important: fetch 2 commits to compare

    - name: Show changed files
      run: |
        echo "🔍 Files changed in this push:"
        git diff --name-only HEAD^ HEAD

    - name: Show diff of changes
      run: |
        echo "📄 Diff of changes:"
        git diff HEAD^ HEAD > changes.diff
        cat changes.diff

    - name: Simulate feeding to model
      run: |
        echo "🤖 Feeding this diff to the model:"
        echo "----------------------------------"
        cat changes.diff
        echo "----------------------------------"
        echo "✅ This is what will be sent to the model for test case adaptation"
